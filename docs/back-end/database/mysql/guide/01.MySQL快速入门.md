<!--#region
@author 吴钦飞
@email wuqinfei@qq.com
@create date 2023-10-21 17:05:23
@modify date 2023-10-23 19:52:37
@desc [description]
#endregion-->


# MySQL 快速入门

## 1. 介绍

什么是数据库?

* 数据库: DataBase (DB)，是存储和管理数据的仓库。
* 数据库管理系统: DataBase Management System (DBMS)，操纵和管理数据库的大型软件。
* SQL: Structured Query Language，操作关系型数据库的编程语言，定义了一套操作关系型数据库统一标准。

数据库产品:

* Oracle: 收费的大型数据库，Oracle 公司的产品。
* MysQL: 开源免费的中小型数据库。Sun 公司收购了 MySQL，Oracle 收购 Sun 公司
* SOL Server: MicroSoft 公司收费的中型的数据库。C#、.net 等语言常使用。
* PostgresQL: 开源免费中小型的数据库
* DB2: IBM 公司的大型收费数据库产品
* SQLite: 嵌入式的微型数据库。如:作为 Android 内置数据库
* MariaDB: 开源免费的中小型的数据库

MySQL 数据库:

1. 数据库设计

    1. MySQL概述
    2. 数据库设计-DDL
    3. 多表设计

2. 数据库操作

    1. 数据库操作-DML
    2. 数据库操作-DQL
    3. 事务
    4. 多表查询

3. 数据库优化

    1. 索引
    2. SQL优化

## 2. MySQL 概述

概要：

* 安装、配置
* 数据模型
* SQL 简介

### 2.1. 安装、配置

1. 下载

    * 下载地址： [https://dev.mysql.com/downloads/mysql/](https://dev.mysql.com/downloads/mysql/)
    * 下载文件： [mysql-8.0.34-winx64.zip](https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.34-winx64.zip)

2. 解压

    * `W:\res\mysql\mysql-8.0.34-winx64`

3. 配置

    1. 添加环境变量

        * MYSQL_HOME=W:\res\mysql\mysql-8.0.34-winx64
        * path=%MYSQL_HOME%\bin
        * 验证

            ```shell
            mysql
            # ERROR 2003 (HY000): Can't connect to MySQL server on 'localhost' (10061)
            ```

    2. 初始化 MySQL

        * 管理员身份运行 CMD
        
            ```shell
            # 生成 %MYSQL_HOME%\data 目录
            mysqld --initialize-insecure
            ```

    3. 注册 MySQL 服务

        * 管理员身份运行 CMD
        
            ```shell
            # 生成 %MYSQL_HOME%\data 目录
            mysqld -install
            
            # Service successfully installed.
            ```

        * 在 windows 搜索中可搜索“服务”配置，查看 MySQL 的服务


    4. 启动 MySQL 服务

        * 管理员身份运行 CMD
        
            ```shell
            # 启动 mysql 服务
            net start mysql

            # MySQL 服务正在启动 .
            # MySQL 服务已经启动成功。

            
            # 停止 mysql 服务
            net stop mysql
            ```

    5. 修改默认账号密码

        * 管理员身份运行 CMD
        
            ```shell
            mysqladmin -u root password 1234

            # mysqladmin: [Warning] Using a password on the command line interface can be insecure.
            # Warning: Since password will be sent to server in plain text, use ssl connection to ensure password safety.
            ```

4. 登录 MySQL

    * 语法： `mysql -u用户名 -p密码 [-h服务器地址 -P端口号]`
        
        ```shell
        # 登录
        mysql -uroot -p1234

        # 退出
        exit
        ```

5. 卸载 MySQL

    * 管理员身份运行 CMD
    
        ```shell
        # 停止服务
        net stop mysql

        # 删除服务
        mysqld -remove mysql

        # 删除目录及环境变量
        ```

### 2.2. 数据模型

关系型数据库(RDBMS):

* 建立在关系模型基础上，由多张相互连接的二维表组成的数据库
* 也就是说，由二维表组成的数据库

特点：

* 使用表存储数据，格式统一，便于维护
* 使用 SQL 语言操作，标准统一，使用方便，可用于复杂查询

### 2.3. SQL 简介

SQL:

* 一门操作关系型数据库的编程语言，定义操作所有关系型数据库的统一标准。

通用语法:

* SOL 语句可以单行或多行书写，以分号结尾
* SQL 语句可以使用空格或缩进来增强语句的可读性
* MySQL 数据库的 SQL 语句不区分大小写
* 注释：

    * 单行注释: 

        * `-- 注释内容`
        * `# 注释内容`, MySQL 特有

    * 多行注释:

        * `/* 注释内容 */`

### 2.4. SQL 简介

SQL语句通常被分为四大类:

* DDL

    * Data Definition Language
    * 数据定义语言，用来定义数据库对象(数据库，表，字段)

* DML

    * Data Manipulation Language
    * 数据定义语言，用来定义数据库对象(数据库，表，字段)

* DQL

    * Data Query Language
    * 数据查询语言，用来查询数据库中表的记录

* DCL

    * Data Control Language
    * 数据控制语言，用来创建数据库用户、控制数据库的访问权限

## 3. 数据库设计-DDL

目录：

* 数据库
* 表 (创建、查询、修改、删除)

### 3.1. 数据库

DDL (数据库操作)：

* 查询

    * 查询所有数据库: `show databases;`
    * 查询当前数据库: `select database();`

* 使用

    * 使用数据库: `use 数据库名;`

* 创建

    * 创建数据库: `create database [ if not exists ] 数据库名;`

* 删除

    * 删除数据库: `drop database [ if exists ] 数据库名;`

* 注意：

    * 关键词 `database` 可以替换为 `schema`
    * 关键词 `databases` 可以替换为 `schemas`

示例:

```text
C:\Users\wuqinfei>mysql -uroot -p1234

mysql> create database db01;

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| db01               |
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.01 sec)

mysql> use db01;
Database changed

mysql> select database();
+------------+
| database() |
+------------+
| db01       |
+------------+
1 row in set (0.00 sec)

mysql> drop database db01;
Query OK, 0 rows affected (0.01 sec)
```

MySQL 客户端工具：

* SQLyog
* Navicat
* DataGrip
* IDEA（已集成 DataGrip）

### 3.2. 表

DDL（表操作）：

* 创建

    ```text
    create table 表名 (

        字段1   字段类型    [约束]   [comment 字段1注释],

        字段2   字段类型    [约束]   [comment 字段2注释],

        ...

        字段n   字段类型    [约束]   [comment 字段n注释]

    ) [comment 表注释] ;
    ```

* 约束

    * 概念: 约束是作用于表中字段上的规则，用于限制存储在表中的数据。
    * 目的: 保证数据库中数据的正确性、有效性和完整性。

约束类别：

* 非空约束

    * `not null`
    * 限制该字段值不能为 null

* 唯一约束

    * `unique`
    * 保证字段的所有数据都是唯一、不重复的

* 主键约束

    * `primary key [auto_increment]`
    * 主键是一行数据的唯一标识，要求非空且唯一

* 默认约束

    * `default`
    * 保存数据时，如果未指定该字段值，则采用默认值

* 外键约束

    * `foreign key`
    * 让两张表的数据建立连接，保证数据的一致性和完整性

示例：

```sql
create table tb_user (
    id int primary key auto_increment comment '主键',
    username varchar(20) unique not null comment '用户名',
    name varchar(10) not null comment '姓名',
    age int comment '年龄',
    gender char(1) default '男' comment '性别'
) comment '用户表';
```