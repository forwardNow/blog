<!--#region
@author 吴钦飞
@email wuqinfei@qq.com
@create date 2025-05-07 22:06:33
@modify date 2025-05-09 18:32:34
@desc [description]
#endregion-->

# MySQL - 基础

大纲: 

* MySQL 概述
* SQL
* 函数
* 约束
* 多表查询
* 事务

## 1. MySQL 概述

### 1.1. 安装

#### 1.1.1. 版本

* 社区版（MySQL Community Server）
* 商业版（MySQL Enterprise Edition）

当前教程使用的是 MySQL Community Server 8.0.26

#### 1.1.2. 下载

地址: https://dev.mysql.com/downloads/windows/installer/8.0.html

#### 1.1.3. 安装

选择完整版的安装。

默认安装目录: C:\Program Files\MySQL

账户: root / 123456

### 1.2. 启动与停止

界面操作步骤:

1. win + R 
2. 输入 services.msc 后按回车
3. 找到 MySQL80 服务

命令行操作步骤:

```shell
# 启动
net start mysql80

# 停止
net stop mysql80
```

### 1.3. 客户端连接

使用 Navicat 连接即可

### 1.4. 数据模型

关系型数据库:

* 概念: 建立在关系模型基础上，由多张相互连接的二维表组成的数据库

## 2. SQL

目录:

* SQL通用语法
* SQL分类
* DDL
* DML
* DQL
* DCL

### 2.1. SQL通用语法

1. 单行或多行书写，分号结尾
2. 不区分大小写，关键字建议大写
3. 单行注释
   * `-- 注释内容`
   * `# 注释内容` （MySQL 特有）
4. 多行注释
   * `/* 注释内容 */`

### 2.2. DDL

#### 2.2.1. 数据库操作

##### 2.2.1.1. 查询

查询所有数据库

```sql
show databases;
```

查询当前数据库:

```sql
select database() ;
```

##### 2.2.1.2. 创建

语法:

```text
create database [ if not exists ] 数据库名 [ default charset 字符集 ] [ collate 排序 规则 ] ;
```

示例:

```sql
-- utf8 使用三个字节
-- utf8mb4 使用四个字节，可以标识更多字符
create database itheima default charset utf8mb4;
```

##### 2.2.1.3. 删除

语法:

```sql
drop database [ if exists ] 数据库名 ;
```

##### 2.2.1.4. 切换

```sql
-- 语法
use 数据库名 ;
```

#### 2.2.2. 表操作

##### 2.2.2.1. 查询

查询当前数据库所有表:

```sql
-- 语法
show tables;
```

查看指定表结构:

```sql
-- 语法
desc 表名 ;
```

查询指定表的建表语句:

```sql
-- 语法
show create table 表名 ;
```

##### 2.2.2.2. 创建

语法:

```sql
CREATE TABLE 表名(
  字段1 字段1类型 [ COMMENT 字段1注释 ],
  字段2 字段2类型 [COMMENT 字段2注释 ],
  字段3 字段3类型 [COMMENT 字段3注释 ],
  ......
  字段n 字段n类型 [COMMENT 字段n注释 ]
) [ COMMENT 表注释 ] ;
```

##### 2.2.2.3. 数据类型

* ![](./images/mysql_data_type_1.png)
* ![](./images/mysql_data_type_2.png)
* ![](./images/mysql_data_type_3.png)

##### 2.2.2.4. 修改

添加字段：

```sql
-- 语法
ALTER TABLE 表名 ADD 字段名 类型 (长度) [ COMMENT 注释 ] [ 约束 ];

-- 示例：为emp表增加一个新的字段”昵称”为nickname，类型为varchar(20)
ALTER TABLE emp ADD nickname varchar(20) COMMENT '昵称';
```

修改数据类型：

```sql
-- 语法
ALTER TABLE 表名 MODIFY 字段名 新数据类型 (长度);
```

修改字段名和字段类型：

```sql
-- 语法
ALTER TABLE 表名 CHANGE 旧字段名 新字段名 类型 (长度) [ COMMENT 注释 ] [ 约束 ];

-- 示例：将emp表的nickname字段修改为username，类型为varchar(30)
ALTER TABLE emp CHANGE nickname username varchar(30) COMMENT '昵称';
```

删除字段：

```sql
-- 语法
ALTER TABLE 表名 DROP 字段名;

-- 示例：将emp表的字段username删除
ALTER TABLE emp DROP username;
```

修改表名：

```sql
-- 语法
ALTER TABLE 表名 RENAME TO 新表名;

-- 示例：将emp表的表名修改为 employee
ALTER TABLE emp RENAME TO employee;
```

##### 2.2.2.5. 删除

删除表：

```sql
-- 语法
DROP TABLE [ IF EXISTS ] 表名;

-- 示例：如果tb_user表存在，则删除tb_user表
DROP TABLE IF EXISTS tb_user;
```

删除指定表, 并重新创建表：

```sql
-- 语法
TRUNCATE TABLE 表名;

-- 在删除表的时候，表中的全部数据也都会被删除。
```

### 2.3. 图形化界面工具

DataGrip

### 2.4. DML

* 添加数据（INSERT）
* 修改数据（UPDATE）
* 删除数据（DELETE）

#### 2.4.1. 添加数据

给指定字段添加数据:

```sql
-- 语法
INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...);

-- 示例：给employee表所有的字段添加数据
insert into employee(id,workno,name,gender,age,idcard,entrydate)
values(1,'1','Itcast','男',10,'123456789012345678','2000-01-01');
```

给全部字段添加数据:

```sql
-- 语法
INSERT INTO 表名 VALUES (值1, 值2, ...);

-- 示例：插入数据到employee表
insert into employee values(2,'2','张无忌','男',18,'123456789012345670','2005-01-
01');
```

批量添加数据:

```sql
-- 语法1
INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...), (值1, 值2, ...), (值
1, 值2, ...) ;

-- 语法2
INSERT INTO 表名 VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...) ;
```

注意事项:

* 插入数据时，指定的字段顺序需要与值的顺序是一一对应的。
* 字符串和日期型数据应该包含在引号中。
* 插入的数据大小，应该在字段的规定范围内。

#### 2.4.2. 修改数据

```sql
-- 语法
UPDATE 表名 SET 字段名1 = 值1 , 字段名2 = 值2 , .... [ WHERE 条件 ] ;

-- 示例：修改id为1的数据, 将name修改为小昭, gender修改为 女
update employee set name = '小昭' , gender = '女' where id = 1;
```

#### 2.4.3. 删除数据

```sql
-- 语法
DELETE FROM 表名 [ WHERE 条件 ] ;

-- 示例：删除gender为女的员工
delete from employee where gender = '女';
```

### 2.5. DQL

#### 2.5.1. 基本语法

```sql
SELECT
   字段列表
FROM
   表名列表
WHERE
   条件列表
GROUP BY
   分组字段列表
HAVING
   分组后条件列表
ORDER BY
   排序字段列表
LIMIT
   分页参数
```

语法拆分:

* 基本查询（不带任何条件）
* 条件查询（WHERE）
* 聚合函数（count、max、min、avg、sum）
* 分组查询（group by）
* 排序查询（order by）
* 分页查询（limit）

#### 2.5.2. 基础查询

查询多个字段：

```sql
-- 语法
SELECT 字段1, 字段2, 字段3 ... FROM 表名 ;

-- 语法：查询所有字段
SELECT * FROM 表名 ;
```

字段设置别名:

```sql
-- 语法1
SELECT 字段1 [ AS 别名1 ] , 字段2 [ AS 别名2 ] ... FROM 表名;

-- 语法2
SELECT 字段1 [ 别名1 ] , 字段2 [ 别名2 ] ... FROM 表名;
```

去除重复记录:

```sql
-- 语法
SELECT DISTINCT 字段列表 FROM 表名;
```

#### 2.5.2. 条件查询

`16. 基础-SQL-DQL-条件查询`