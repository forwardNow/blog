<!--#region
@author 吴钦飞
@email wuqinfei@qq.com
@create date 2025-12-04 18:10:30
@modify date 2025-12-05 12:45:28
@desc [description]
#endregion-->

# MybatisPlus教程-黑马

官网: https://www.baomidou.com/

目录:

* 快速入门
* 核心功能
* 扩展功能
* 插件功能

## 1. 快速入门

目录:

* 入门案例
   * 学会 MP 的基本用法
   * 体会 MP 的无侵入和方便快捷的特点
* 常见注解
* 常见配置

### 1.1. 入门案例

使用 MybatisPlus 的基本步骤:

1. 引入 MybatisPlus 依赖，代替 Mybatis 依赖
2. 定义 Mapper 接口并继承 BaseMapper

#### 1.1.1. 引入依赖

MyBatisPlus 官方提供了 starter，其中集成了 Mybatis 和 MybatisPlus 的所有功能，并且实现了自动装配效果。

因此我们可以用MybatisPlus的starter代替Mybatis的starter：

```xml
<!--
<dependency>
   <groupId>org.mybatis.spring.boot</groupId>
   <artifactId>mybatis-spring-boot-starter</artifactId>
   <version>2.3.1</version>
</dependency>
-->
<dependency>
   <groupId>com.baomidou</groupId>
   <artifactId>mybatis-plus-boot-starter</artifactId>
   <version>3.5.3.1</version>
</dependency>
```

#### 1.1.2. 定义 Mapper 接口

自定义的 Mapper 继承 MybatisPlus 提供的 BaseMapper 接口：

```java
public interface UserMapper extends BaseMapper<User> {
   
}
/*
继承 BaseMapper 后，就有如下 增删改查方法:
   
   int insert(T entity);

   int deleteById(Serializable id);
   int deleteById(T entity);
   int deleteByMap(Map<String, Object> columnMap);
   int delete(Wrapper<T> queryWrapper);
   int deleteBatchIds(Collection<?> idList);

   int updateById(T entity);
   int update(T entity, Wrapper<T> updateWrapper);

   T selectById(Serializable id);
   List<T> selectBatchIds(Collection<? extends Serializable> idList);
   List<T> selectByMap(Map<String, Object> columnMap);
   T selectOne(Wrapper<T> queryWrapper)
   boolean exists(Wrapper<T> queryWrapper)

   Long selectCount(Wrapper<T> queryWrapper);
   List<T> selectList(Wrapper<T> queryWrapper);
   List<Map<String, Object>> selectMaps(Wrapper<T> queryWrapper);
   List<Object> selectObjs(Wrapper<T> queryWrapper);
   <P extends IPage<T>> P selectPage(P page, Wrapper<T> queryWrapper);
   <P extends IPage<Map<String, Object>>> P selectMapsPage(P page, Wrapper<T> queryWrapper);
*/
```

### 1.2. 常见注解

#### 1.2.1. 原理

MyBatisPlus 通过扫描实体类，并基于反射获取实体类信息作为数据库表信息。

1.根据 `BaseMapper<User>` 中的 `User` 实体类信息

```java
public interface UserMapper extends BaseMapper<User> { }

@Data
public class User {
    private Long id;
    private String username;
    private String password;
    private String phone;
    private String info;
    private Integer status;
    private Integer balance;
    private LocalDateTime createTime;
    private LocalDateTime updateTime;
}
```

2.解析实体类获取表信息

* 表名: 类名 驼峰转下划线
* 主键: 名为 id 的成员变量
* 字段名: 成员变量名 驼峰转下划线

以上是按约定来，如果不按约定来则需要显式设置

#### 1.2.2. 基础注解

MybatisPlus 中比较常用的几个注解如下：

* `@TableName` : 指定表名
* `@TableId` : 指定表中的主键字段信息
* `@TableField` : 指定表中的普通字段信息


`@TableName`:

* 当 类名转下划线 后，与数据库表名不一致，则需要显式设置


`@TableId`:

* 设置主键字段及类型(`type`)
* 类型的值为 IdType 枚举类型
* `IdType.AUTO` : 数据库自增长
* `IdType.INPUT` : 通过set方法自行输入
* `IdType.ASSIGN_ID` : 默认。分配 ID，接口 IdentifierGenerator 的方法 nextId 来生成 id，默认实现类为 DefaultIdentifierGenerator 雪花算法


`@TableField`:

* 成员变量名与数据库字段名不一致
* 成员变量名以 `is` 开头，且是布尔值。(反射时通常会去掉 `is`)
   * MySQL不原生支持布尔类型，但 `bit(1)` 或‌ `TINYINT(1)` 常作为替代方案
   * `bit(1)` 更直接映射二进制逻辑，而 `TINYINT(1)` 兼容性更广
   * `bit` 类型存储二进制值，每个位只能是 0 或 1，基础长度为 1 位，默认长度为 1。‌‌
* 成员变量名与数据库关键字冲突。（需要转义）
* 成员变量不是数据库字段

示例:

```java
@TableName("tb_user")
public class User {
   @TableId(value="id", type=IdType.AUTO)
   private Long id;

   @TableField("username")
   private String name;

   @TableField("is_married")
   private Boolean isMarried; // 对应的数据库字段类型 bit(1)

   @TableField("`order`")
   private Integer order;

   @TableField(exist = false)
   private String address;
}
```

#### 1.2.3. 总结

MybatisPlus 是如何获取实现CRUD的数据库表信息的？

* 默认以类名驼峰转下划线作为表名
* 默认把名为id的字段作为主键
* 默认把变量名驼峰转下划线作为表的字段名


MybatisPlus 的常用注解有哪些？

* @TableName：指定表名称及全局配置
* @TableId：指定id字段及相关配置
* @TableField：指定普通字段及相关配置


IdType的常见类型有哪些？

* AUTO 
* ASSIGN_ID
* INPUT


使用 @TableField 的常见场景是？

* 成员变量名与数据库字段名不一致
* 成员变量名以is开头，且是布尔值
* 成员变量名与数据库关键字冲突
* 成员变量不是数据库字段
