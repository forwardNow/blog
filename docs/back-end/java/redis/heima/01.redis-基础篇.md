<!--#region
@author 吴钦飞
@email wuqinfei@qq.com
@create date 2025-09-19 16:47:43
@modify date 2025-09-23 09:00:28
@desc [description]
#endregion-->

# redis-基础篇

Redis

* 键值数据库
* NoSQL数据库

目录:

* 初识 Redis

   * 认识 NoSQL
   * 认识 Redis
   * 安装 Redis

* Redis 常见命令

   * 5 种常见数据结构
   * 通用命令
   * 不同数据结构的操作命令

* Redis 的 Java 客户端

   * Jedis 客户端
   * SpringDataRedis 客户端

## 1. 初识 Redis

### 1.1. 认识 NoSQL

| 类型 | SQL | NoSQL |
| - | - | - |
| 数据结构 | 结构化 | 非结构化（松散） |
| 数据关联 | 关联的（外键） | 无关联的 |
| 查询方式 | SQL查询（统一的语法） | 非SQL（五花八门） |
| 事务特性 | 事务 ACID | BASE |
| 存储方式 | 磁盘 | 内存 |
| 扩展性 | 垂直 | 水平 |
| 使用场景 | 1）数据结构固定 <br />2）数据安全性、一致性要求较高 | 1）数据结构不固定<br />2）数据安全性、一致性要求不高<br />3）对性能要求高 |

### 1.2. 认识 Redis

Redis 诞生于 2009 年，是一个基于内存的键值型 NoSQL 数据库

全称：

* Remote Dictionary Server
* 远程词典服务器

特征：

* 键值（key-value）型，value 支持多种不同数据结构，功能丰富
* 单线程，每个命令具备原子性
* 低延迟、速度快（基于内存、IO多路复用、良好的编码）
* 支持数据持久化
* 支持主动集群、分片集群
* 支持多语言客户端

### 1.3. 安装 Redis

下载: (windows版本)

* 地址: https://github.com/tporadowski/redis/releases
* 版本: Redis for Windows 5.0.14.1
* 文件: Redis-x64-5.0.14.1.zip 

启动:

```shell
D:

cd D:\soft\redis-5.0.14.1

redis-server.exe redis.windows.conf
```

配置: (`redis.windows.conf`)

```properties
# 允许访问的地址，默认是127.0.0.1，会导致只能在本地访问。
# 修改为0.0.0.0则可以在任意IP访问，生产环境不要设置为0.0.0.0
bind 0.0.0.0

# 守护进程，修改为yes后即可后台运行
daemonize yes 

# 密码，设置后访问Redis必须输入密码
requirepass 123321



# 监听的端口
port 6379

# 工作目录，默认是当前目录，也就是运行redis-server时的命令，日志、持久化等文件会保存在这个目录
dir .

# 数据库数量，设置为1，代表只使用1个库，默认有16个库，编号0~15
databases 1

# 设置redis能够使用的最大内存
maxmemory 512mb

# 日志文件，默认为空，不记录日志，可以指定日志文件名
logfile "redis.log"
```

参考:

* [Window下Redis的安装和部署详细图文教程（Redis的安装和可视化工具的使用）](https://blog.csdn.net/weixin_44893902/article/details/123087435)

### 1.4. 命令行客户端

在 Redis 安装目录存在 redis-cli.exe 客户端

```shell
D:\install\redis-5.0.14.1>redis-cli -h 127.0.0.1 -p 6379

127.0.0.1:6379> ping
PONG

127.0.0.1:6379> set name zhangsan
OK

127.0.0.1:6379> get name
"zhangsan"
```

### 1.5. 图形化桌面客户端

GitHub上的大神编写了Redis的图形化桌面客户端，地址：https://github.com/uglide/RedisDesktopManager

不过该仓库提供的是RedisDesktopManager的源码，并未提供 windows 安装包。

在下面这个仓库可以找到安装包：https://github.com/lework/RedisDesktopManager-Windows/releases

## 2. Redis 常见命令

### 2.1. Redis 数据结构介绍

Redis 是一个 key-value 的数据库， key 一般是 String 类型，value 的类型多种多样:

基本类型:

* String
* Hash
* List
* Set
* SortedSet

特殊类型:

* GEO
* BitMap
* HyperLog

帮助文档:

* https://redis.io/docs/latest/commands/


### 2.2. Redis 通用命令

常见指定：

* KEYS: 查看符合模板的所有 key，不建议在生产环境使用
* DEL: 删除指定的 key
* EXISTS: key 是否存在
* EXPIRE: 设置有效期，到期自动删除
* TTL: 查看剩余有效期；`-1` 永久有效, `-2` 已删除

KEYS 的模式:

```text
Supported glob-style patterns:

   h?llo       matches hello, hallo and hxllo
   h*llo       matches hllo and heeeello
   h[ae]llo    matches hello and hallo, but not hillo
   h[^e]llo    matches hallo, hbllo, ... but not hello
   h[a-b]llo   matches hallo and hbllo
```

示例:

```shell
127.0.0.1:6379> MSET name ZhangSan age 18

127.0.0.1:6379> help KEYS

  KEYS pattern
  summary: Find all keys matching the given pattern
  since: 1.0.0
  group: generic

127.0.0.1:6379> KEYS *
1) "age"
2) "name"

127.0.0.1:6379> DEL age
(integer) 1

127.0.0.1:6379> KEYS *
1) "name"

127.0.0.1:6379> EXISTS name
(integer) 1

127.0.0.1:6379> EXISTS age
(integer) 0

127.0.0.1:6379> EXPIRE name 10
(integer) 1

127.0.0.1:6379> TTL name
(integer) 1

127.0.0.1:6379> TTL name
(integer) -2

127.0.0.1:6379> KEYS *
(empty list or set)
```

### 2.3. String 类型

说明:

* 字符串类型，最简单的存储类型

value 是字符串，可以分为三类:

* string
* int
* float

常见命令:

* SET: 增 或 改
* GET: 查

* MSET: 批量增
* MGET: 批量查

* INCR: int 自增1
* INCRBY: int 自增指定步长
* INCRBYFLOAT: float 自增指定步长

* SETNX: 增。不存在时新增
* SETEX: 增或改。设置有效期

示例:

```shell
127.0.0.1:6379> set name zhangsan
OK
127.0.0.1:6379> get name
"zhangsan"
127.0.0.1:6379> set name zhangsan2
OK
127.0.0.1:6379> get name
"zhangsan2"


127.0.0.1:6379> mset k1 v1 k2 v2
OK
127.0.0.1:6379> keys *
1) "name"
2) "k1"
3) "k2"
127.0.0.1:6379> mget k1 k2
1) "v1"
2) "v2"


127.0.0.1:6379> set age 18
OK
127.0.0.1:6379> get age
"18"
127.0.0.1:6379> incr age
(integer) 19
127.0.0.1:6379> incrby age 2
(integer) 21
127.0.0.1:6379> incrby age -2
(integer) 19
127.0.0.1:6379> set score 82.5
OK
127.0.0.1:6379> incrbyfloat score 0.5
"83"
127.0.0.1:6379> incrbyfloat score 0.5
"83.5"


127.0.0.1:6379> setnx name zhangsan2
(integer) 0
127.0.0.1:6379> setnx name2 zhangsan2
(integer) 1
# 等价于如下命令
127.0.0.1:6379> set name2 zhangsan2 nx
(nil)


127.0.0.1:6379> set name3 lisi
OK
127.0.0.1:6379> setex name3 10 lisi2
OK
127.0.0.1:6379> get name3
"lisi2"
127.0.0.1:6379> ttl name3
(integer) -2
127.0.0.1:6379> set name3 lisi
OK
# 等价于如下命令
127.0.0.1:6379> set name3 lisi ex 10
OK
127.0.0.1:6379> ttl name3
(integer) 8
```

### 2.4. key 的格式

建议格式:

* `项目名:业务名:类型:id`

说明:

* 通过 `:` 分隔的 key 在图形界面中会形成层级结构

注意:

* windows cmd 要设置 UTF-8 编码，否则会导致乱码
* 在 CMD 执行: `chcp 65001`

示例:

```shell
set user:1 '{"id":1,"name":"zhangsan","age":18}'
set user:2 '{"id":2,"name":"lisi","age":20}'

set product:1 '{"id":1,"name":"小米11","price":1888}'
set product:2 '{"id":2,"name":"荣耀100","price":1999}'

keys *
# 1) "product:1"
# 2) "product:2"
# 3) "user:2"
# 4) "user:1"
```


### Hash 类型
### List 类型
### Set 类型
### SortedSet 类型