# webpack 项目配置

## 1. 介绍

搭建：

1. react 项目脚手架
2. vue 项目脚手架

## 2. react 脚手架

### 2.1. 项目结构

```text
react-proj/
  config/
    webpack.dev.js
  dist/
  node_modules/
  public/
    index.html
  src/
  .browserslistrc
  .eslintrc.js
  babel.config.js
  package.json
  package-lock.json
```

### 2.2. 安装

```shell
# webpack cli dev-server
npm i -D webpack webpack-cli webpack-dev-server

## "webpack": "^5.81.0", "webpack-cli": "^5.0.2", "webpack-dev-server": "^4.13.3"

# css
npm i -D style-loader css-loader 
npm i -D less-loader 
npm i -D sass sass-loader
npm i -D stylus-loader

npm i -D postcss-loader postcss postcss-preset-env

## "style-loader": "^3.3.2", "css-loader": "^6.7.3",
## "less-loader": "^11.1.0",
## "sass": "^1.62.1", "sass-loader": "^13.2.2",
## "stylus-loader": "^7.1.0",

## "postcss": "^8.4.23", "postcss-loader": "^7.3.0", "postcss-preset-env": "^8.3.2",

# js
npm i -D eslint-webpack-plugin eslint-config-react-app
npm i -D babel-loader @babel/core babel-preset-react-app

## "eslint-webpack-plugin": "^4.0.1", "eslint-config-react-app": "^7.0.1",
## "babel-loader": "^9.1.2", "@babel/core": "^7.21.5", "babel-preset-react-app": "^10.0.1",

# html
npm i -D html-webpack-plugin

## "html-webpack-plugin": "^5.5.1",

# react
npm i react react-dom

## "react": "^18.2.0", "react-dom": "^18.2.0"

# others
npm i -D cross-env

## "cross-env": "^7.0.3",
```

### 2.3. 其他配置

#### 2.3.1. .browserslistrc

```text
last 2 version
> 1%
not dead
```

#### 2.3.2. .eslintrc.js

```javascript
module.exports = {
  extends: ['react-app'], // 继承 react 官方规则
  parserOptions: {
    babelOptions: {
      presets: [
        // 解决页面报错问题
        ['babel-preset-react-app', false],
        'babel-preset-react-app/prod',
      ],
    },
  },
};
```

#### 2.3.3. babel.config.js

```javascript
module.exports = {
  /*
    使用 react 官方规则，包含：
      @babel/preset-env
      corejs
      @babel/plugin-transform-runtime
   */
  presets: ['react-app'],
};
```

### 2.4. 报错

#### 2.4.1. NODE_ENV

错误信息：

```text
Using `babel-preset-react-app` requires that you specify `NODE_ENV` or `BABEL_ENV` environment variables.
```

解决方案：

1. 安装 cross-env
  
  ```shell
  npm i -D cross-env
  ```

2. 在 npm scripts 中设置临时环境变量 NODE_ENV=development
  
  ```json
  {
    "scripts": {
      "start": "npm run dev",
      "dev": "cross-env NODE_ENV=development webpack serve --config ./config/webpack.dev.js"
    }
  } 
  ```

#### 2.4.2. 省略 .jsx 后缀不识别

错误信息：

```text
Module not found: Error: Can't resolve './App' in 'D:\dev\GitHub\blog\codes\frontend\webpack\guide\react-proj\src'
```

解决方案：

* 在 webpack.config.js 中设置

```javascript
module.exports = {
  //...
  resolve: {
    // default:  ['.js', '.json', '.wasm']
    extensions: ['.js', '.jsx', '.json', '.wasm'],
  },
};
```

### 2.5. webpack.js

## 3. vue 脚手架

## 4. 总结
