# 使用 Vue 脚手架

## 1. 初始化脚手架

### 1.1. 说明

Vue 脚手架是 Vue 官方提供的标准化开发工具（开发平台）

最新的版本是 5.x

官网: [https://cli.vuejs.org/zh/](https://cli.vuejs.org/zh/)

### 1.2. 步骤

1.全局安装 @vue/cli ：

```shell
# 设置淘宝镜像源
npm config set registry https://registry.npm.taobao.org

# 全局安装
npm install -g @vue/cli

# 查看版本
vue -V
# @vue/cli 5.0.8
```

2.创建项目：

```shell
# 切换到工作空间

vue create vue-proj
```

3.启动项目：

```shell
npm run serve
```

4.访问 [http://localhost:8080/](http://localhost:8080/)

### 1.3. webpack 配置

Vue 脚手架隐藏了所有 webpack 相关的配置，

若想查看具体的 webpack 配置，请执行：

```shell
vue inspect > webpack-config-output.js
```

### 1.4. 模板项目结构

```text
vue-proj/
  public/
    favicon.ico       # 页签图标
    index.html        # 主页面
  src/
    assets/           # 存放静态资源
      logo.png
    component/        # 存放组件
      HelloWorld.vue
    App.vue           # 汇总所有组件
    main.js           # 入口文件
  .gitignore          # git 版本管制忽略的配置
  babel.config.js     # babel 的配置文件
  package.json        # 应用包配置文件
  README.md           # 应用描述文件
  package-lock.json   # 包版本控制文件
```

`vue-proj/public/index.html`：

```html

<!--  
  BASE_URL: 指向 public 目录
-->

<link rel="icon" href="<%= BASE_URL %>favicon.ico">
```

## 2. Vue 文件说明

### 2.1. 引入 Vue

`vue-proj/main.js` ：

```javascript
// 引入的是哪个文件???
import Vue from 'vue';
```

### 2.2. 引入的是哪个

查看 `node_modules/vue/package.json` :

```json
{
  "name": "vue",
  "version": "2.7.14",

  "main": "dist/vue.runtime.common.js",
  "module": "dist/vue.runtime.esm.js",

  "unpkg": "dist/vue.js",
  "jsdelivr": "dist/vue.js",
}
```

### 2.3. package.json 相关配置

#### 2.3.1. npm 包入口配置

| 配置 | 规范 | 说明|
| - | - | - |
| module | esm | 现代 ECMA 规范，摇树性能好，首推使用 |
| main | cjs | node 使用的 require 规范，无摇树 |
| browser | umd | 支持 cjs、amd、global(window) ，一般用在浏览器中 |

对 webpack 而言，使用的顺序为： `browser` -> `module` -> `main`

#### 2.3.2. CDN 相关配置

| 配置 | 说明 |
| - | - |
| unpkg | npm: `unpkg.com/:package@:version/:file`  |
| jsdelivr | npm: `https://cdn.jsdelivr.net/npm/包名@版本号/目录` <br> github: `https://cdn.jsdelivr.net/gh/用户名称/仓库名称@版本号/目录`  |

### 2.4. vue 文件类型

| 文件名 | 说明 |
| - | - |
| vue.js | 完整版，包含 core(核心) 和 compiler(模板编译器) |
| vue.runtime.js | 运行时版本，只有 core |

| 文件名 | 说明 |
| - | - |
| vue.js | 完整版，UMD 版 |
| vue.common.js | 完整版，CommonJS 版 |
| vue.esm.js | 完整版，ES 版 |

### 2.5. 总结

**开发态：**

用 `vue-template-compiler` 编译 `.vue` 文件

**运行态：**

使用 `vue.runtime.js`

**没有模板编译器：**

* 不能使用 `options.template` 配置项
* 需要使用 `options.render` 配置项来渲染模板


  ```javascript
  import App from './App.vue'
  new Vue({
    render: function(createElement) {
      return createElement(App);
    }
  });
  ```

**使用完整版：**

```javascript
import Vue from 'vue/dist/vue.esm';
```

**package.json 入口配置：**

* 不要使用 `browser`
* 优先使用 `module`
* `module` 和 `main` 同时存在，webpack 优先使用 `module`

### 2.6. 参考

* [package.json配置详解，让你一看就会（上）](https://juejin.cn/post/7027293182249402405)
* [浅谈package.json中main、module、browser字段对webpack的重大影响](https://blog.csdn.net/qq_21567385/article/details/112392354)

## 3. vue.config.js 配置文件

[https://cli.vuejs.org/zh/config/](https://cli.vuejs.org/zh/config/)

`vue inspect > output.js` 可以导出 webpack 配置项

常用配置：

| 配置 | 说明 |
| - | - |
| lintOnSave | 每次保存时 lint 代码，`true` 或 `'warning'` 不会导致编译失败 |
| pages | 多页面配置 |

## 4. ref 属性

作用： 给元素或子组件注册引用

使用：

```html
<template>
  <!-- 普通 HTML 元素 -->
  <div ref='elt'></div>

  <!-- 组件 -->
  <Person ref='cp' />
</template>
<script>
  export default {
    mounted() {
      this.$refs.elt; // 返回 DOM 元素（HTMLElement 的实例）
      this.$refs.cp;  // 返回 vc（VueComponent 的实例，Person 的实例）
    }
  }
</script>
```

